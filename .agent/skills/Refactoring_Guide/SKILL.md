---
name: refactoring-guide
description: コードのリファクタリングを行う際に従うべき設計ルールと手順。
---

# リファクタリング・ガイド (Refactoring Guide)

既存のコードを壊さずに変更するための戦略的なルール。

## 5つの原則
1.  **関心の分離**: 1つの関数、1つの仕事。
2.  **高凝集**: 関連するコードは一緒に保つ。
3.  **疎結合**: モジュール間の依存関係を最小限にする。
4.  **抽象化**: 実装の詳細を隠す。
5.  **DRY**: 繰り返さない（ただし、間違った抽象化よりは重複を優先）。

## ワークフロー

1.  **分析**: `git diff` で作業中の変更を確認します。
2.  **特定**: 「臭い」を見つけます（長いメソッド？神クラス？）。
3.  **リファクタリング**:
    - メソッドの抽出
    - 変数のリネーム
    - クラスの移動
4.  **検証**: 直ちに `nr test` (またはプロジェクトのテストコマンド) を実行します。

## ディレクトリールール
- 同一タイプのファイルが3つ以上ある場合、サブディレクトリを作成します。
- **シンプル第一**: オーバーエンジニアリングを避けます。

## 制約
**壊れたコードを決してコミットしないでください。** リファクタリングの前にエラーを修正してください。
